{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": { "type": "grafana", "uid": "-- Grafana --" },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "title": "Service Overview",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
      "id": 1,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "Uptime",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "process_uptime_seconds{application=\"$application\", instance=~\".*\"}",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 100 },
              { "color": "red", "value": 500 }
            ]
          },
          "unit": "reqps"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "Request Rate",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum(rate(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\"}[$__rate_interval]))",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "red", "value": 5 }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "Error Rate (%)",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "(sum(rate(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\", status=~\"5..\"}[$__rate_interval])) or vector(0)) / sum(rate(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\"}[$__rate_interval])) * 100",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 0.5 },
              { "color": "red", "value": 1 }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "Avg Response Time",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum(rate(http_server_requests_seconds_sum{application=\"$application\", uri!=\"/actuator/prometheus\"}[$__rate_interval])) / sum(rate(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\"}[$__rate_interval]))",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "red", "value": 3 }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "P95 Response Time",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.95, sum(rate(http_server_requests_seconds_bucket{application=\"$application\", uri!=\"/actuator/prometheus\"}[$__rate_interval])) by (le))",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 100 },
              { "color": "red", "value": 300 }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "title": "Active Threads",
      "type": "stat",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_threads_live_threads{application=\"$application\"}",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
      "id": 200,
      "title": "RED Metrics (Rate, Errors, Duration)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" }
          },
          "unit": "reqps"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 6 },
      "id": 10,
      "options": {
        "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Request Rate by URI",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (uri) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval]))",
          "legendFormat": "{{uri}}",
          "refId": "A",
          "exemplar": true
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" }
          },
          "unit": "reqps"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 6 },
      "id": 11,
      "options": {
        "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Request Rate by Status Code",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (status) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval]))",
          "legendFormat": "{{status}}",
          "refId": "A",
          "exemplar": true
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "scheme",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "line" }
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "red", "value": 5 }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 6 },
      "id": 12,
      "options": {
        "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Error Rate %",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "(sum(rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\", status=~\"5..\"}[$__rate_interval])) or vector(0)) / sum(rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) * 100",
          "legendFormat": "Error Rate",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 50,
            "gradientMode": "none",
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "normal" }
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 14 },
      "id": 13,
      "options": {
        "legend": { "calcs": ["sum"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Error Count by URI",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (uri) (increase(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\", status=~\"5..\"}[$__rate_interval])) or vector(0)",
          "legendFormat": "{{uri}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" }
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 14 },
      "id": 14,
      "options": {
        "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Avg Response Time by URI",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (uri) (rate(http_server_requests_seconds_sum{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) / sum by (uri) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval]))",
          "legendFormat": "{{uri}}",
          "refId": "A",
          "exemplar": true
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" }
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 14 },
      "id": 15,
      "options": {
        "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "title": "Response Time Percentiles",
      "type": "timeseries",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.50, sum(rate(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) by (le))",
          "legendFormat": "P50",
          "refId": "A",
          "exemplar": true
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.95, sum(rate(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) by (le))",
          "legendFormat": "P95",
          "refId": "B",
          "exemplar": true
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.99, sum(rate(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) by (le))",
          "legendFormat": "P99",
          "refId": "C",
          "exemplar": true
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "scheme" },
          "custom": {
            "fillOpacity": 80,
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "scaleDistribution": { "type": "linear" }
          }
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 22 },
      "id": 16,
      "options": {
        "calculate": false,
        "cellGap": 1,
        "color": {
          "exponent": 0.5,
          "fill": "dark-orange",
          "mode": "scheme",
          "reverse": false,
          "scale": "exponential",
          "scheme": "Oranges",
          "steps": 64
        },
        "tooltip": { "mode": "single", "yHistogram": true },
        "yAxis": { "axisPlacement": "left", "unit": "s" }
      },
      "title": "Response Time Heatmap",
      "type": "heatmap",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum(increase(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__rate_interval])) by (le)",
          "legendFormat": "{{le}}",
          "refId": "A",
          "format": "heatmap"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 30 },
      "id": 300,
      "title": "Endpoints Table",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": { "type": "auto" },
            "inspect": false
          }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Throughput" },
            "properties": [{ "id": "unit", "value": "reqps" }, { "id": "decimals", "value": 2 }]
          },
          {
            "matcher": { "id": "byName", "options": "Avg Latency" },
            "properties": [{ "id": "unit", "value": "s" }, { "id": "decimals", "value": 3 }]
          },
          {
            "matcher": { "id": "byName", "options": "P95" },
            "properties": [{ "id": "unit", "value": "s" }, { "id": "decimals", "value": 3 }]
          },
          {
            "matcher": { "id": "byName", "options": "P99" },
            "properties": [{ "id": "unit", "value": "s" }, { "id": "decimals", "value": 3 }]
          },
          {
            "matcher": { "id": "byName", "options": "Error Rate (%)" },
            "properties": [
              { "id": "unit", "value": "percent" },
              { "id": "decimals", "value": 2 },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "red", "value": 5 }] } },
              { "id": "custom.cellOptions", "value": { "mode": "basic", "type": "color-background" } }
            ]
          }
        ]
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 31 },
      "id": 20,
      "options": {
        "cellHeight": "sm",
        "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false },
        "showHeader": true,
        "sortBy": [{ "desc": true, "displayName": "Throughput" }]
      },
      "title": "Endpoints",
      "type": "table",
      "targets": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (uri, method) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range]))",
          "format": "table",
          "instant": true,
          "legendFormat": "",
          "refId": "Throughput"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum by (uri, method) (rate(http_server_requests_seconds_sum{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range])) / sum by (uri, method) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range]))",
          "format": "table",
          "instant": true,
          "legendFormat": "",
          "refId": "AvgLatency"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.95, sum by (uri, method, le) (rate(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range])))",
          "format": "table",
          "instant": true,
          "legendFormat": "",
          "refId": "P95"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.99, sum by (uri, method, le) (rate(http_server_requests_seconds_bucket{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range])))",
          "format": "table",
          "instant": true,
          "legendFormat": "",
          "refId": "P99"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "(sum by (uri, method) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\", status=~\"5..\"}[$__range])) or vector(0)) / sum by (uri, method) (rate(http_server_requests_seconds_count{application=\"$application\", uri=~\"$uri\", uri!=\"/actuator/prometheus\", method=~\"$method\"}[$__range])) * 100",
          "format": "table",
          "instant": true,
          "legendFormat": "",
          "refId": "ErrorRate"
        }
      ],
      "transformations": [
        {
          "id": "merge",
          "options": {}
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": { "Time": true },
            "renameByName": {
              "uri": "URI",
              "method": "Method",
              "Value #Throughput": "Throughput",
              "Value #AvgLatency": "Avg Latency",
              "Value #P95": "P95",
              "Value #P99": "P99",
              "Value #ErrorRate": "Error Rate (%)"
            },
            "indexByName": {
              "URI": 0,
              "Method": 1,
              "Throughput": 2,
              "Avg Latency": 3,
              "P95": 4,
              "P99": 5,
              "Error Rate (%)": 6
            }
          }
        },
        {
          "id": "filterByValue",
          "options": {
            "filters": [
              {
                "fieldName": "Throughput",
                "config": {
                  "id": "greater",
                  "options": { "value": 0 }
                }
              }
            ],
            "match": "any",
            "type": "include"
          }
        }
      ]
    },
    {
      "collapsed": true,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 39 },
      "id": 500,
      "title": "JVM & System",
      "type": "row",
      "panels": [
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "max": 1,
              "min": 0,
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 0, "y": 41 },
          "id": 40,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "CPU Usage",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "system_cpu_usage{application=\"$application\"}",
              "legendFormat": "System CPU",
              "refId": "A"
            },
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "process_cpu_usage{application=\"$application\"}",
              "legendFormat": "Process CPU",
              "refId": "B"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 6, "y": 41 },
          "id": 41,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "JVM Heap Memory",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_memory_used_bytes{application=\"$application\", area=\"heap\"}",
              "legendFormat": "Used {{id}}",
              "refId": "A"
            },
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_memory_max_bytes{application=\"$application\", area=\"heap\"}",
              "legendFormat": "Max {{id}}",
              "refId": "B"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 12, "y": 41 },
          "id": 42,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "JVM Non-Heap Memory",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_memory_used_bytes{application=\"$application\", area=\"nonheap\"}",
              "legendFormat": "Used {{id}}",
              "refId": "A"
            },
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_memory_max_bytes{application=\"$application\", area=\"nonheap\"}",
              "legendFormat": "Max {{id}}",
              "refId": "B"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 10,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 18, "y": 41 },
          "id": 43,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "JVM Threads",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_threads_live_threads{application=\"$application\"}",
              "legendFormat": "Live",
              "refId": "A"
            },
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_threads_daemon_threads{application=\"$application\"}",
              "legendFormat": "Daemon",
              "refId": "B"
            },
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "jvm_threads_peak_threads{application=\"$application\"}",
              "legendFormat": "Peak",
              "refId": "C"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "s"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 49 },
          "id": 44,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "GC Pause Duration",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "rate(jvm_gc_pause_seconds_sum{application=\"$application\"}[$__rate_interval])",
              "legendFormat": "{{action}} - {{cause}}",
              "refId": "A"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "ops"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 49 },
          "id": 45,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "GC Count",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "rate(jvm_gc_pause_seconds_count{application=\"$application\"}[$__rate_interval])",
              "legendFormat": "{{action}} - {{cause}}",
              "refId": "A"
            }
          ]
        }
      ]
    },
    {
      "collapsed": true,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 41 },
      "id": 600,
      "title": "Application Logs - Loki",
      "type": "row",
      "panels": [
        {
          "datasource": { "type": "loki", "uid": "loki" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "bars",
                "fillOpacity": 50,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 1,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "normal" }
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 42 },
          "id": 50,
          "options": {
            "legend": { "calcs": ["sum"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "Log Volume by Level",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "loki", "uid": "loki" },
              "expr": "sum by (level) (count_over_time({app=\"chaekpool-api\", environment=\"$environment\"} [$__auto]))",
              "legendFormat": "{{level}}",
              "refId": "A"
            }
          ]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" }
              },
              "unit": "ops"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 42 },
          "id": 51,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "title": "Logback Events (Prometheus)",
          "type": "timeseries",
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "expr": "sum by (level) (rate(logback_events_total{application=\"$application\"}[$__rate_interval]))",
              "legendFormat": "{{level}}",
              "refId": "A"
            }
          ]
        },
        {
          "datasource": { "type": "loki", "uid": "loki" },
          "gridPos": { "h": 10, "w": 24, "x": 0, "y": 50 },
          "id": 52,
          "options": {
            "dedupStrategy": "none",
            "enableLogDetails": true,
            "prettifyLogMessage": false,
            "showCommonLabels": false,
            "showLabels": false,
            "showTime": true,
            "sortOrder": "Descending",
            "wrapLogMessage": true
          },
          "title": "Error Logs",
          "type": "logs",
          "targets": [
            {
              "datasource": { "type": "loki", "uid": "loki" },
              "expr": "{app=\"chaekpool-api\", environment=\"$environment\", level=\"ERROR\"}",
              "refId": "A"
            }
          ]
        },
        {
          "datasource": { "type": "loki", "uid": "loki" },
          "gridPos": { "h": 12, "w": 24, "x": 0, "y": 60 },
          "id": 53,
          "options": {
            "dedupStrategy": "none",
            "enableLogDetails": true,
            "prettifyLogMessage": false,
            "showCommonLabels": false,
            "showLabels": false,
            "showTime": true,
            "sortOrder": "Descending",
            "wrapLogMessage": true
          },
          "title": "All Logs",
          "type": "logs",
          "targets": [
            {
              "datasource": { "type": "loki", "uid": "loki" },
              "expr": "{app=\"chaekpool-api\", environment=\"$environment\"}",
              "refId": "A"
            }
          ]
        }
      ]
    },
    {
      "collapsed": true,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 42 },
      "id": 700,
      "title": "Distributed Traces - Jaeger",
      "type": "row",
      "panels": [
        {
          "datasource": { "type": "jaeger", "uid": "jaeger" },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "auto",
                "cellOptions": { "type": "auto" },
                "inspect": false
              }
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "traceID" },
                "properties": [
                  {
                    "id": "links",
                    "value": [
                      {
                        "title": "View Trace",
                        "url": "/explore?schemaVersion=1&panes={\"0\":{\"datasource\":\"jaeger\",\"queries\":[{\"refId\":\"A\",\"query\":\"${__value.raw}\",\"datasource\":{\"type\":\"jaeger\",\"uid\":\"jaeger\"}}],\"range\":{\"from\":\"now-1h\",\"to\":\"now\"}}}&orgId=1",
                        "targetBlank": true
                      }
                    ]
                  }
                ]
              },
              {
                "matcher": { "id": "byName", "options": "startTime" },
                "properties": [{ "id": "unit", "value": "dateTimeFromNow" }]
              },
              {
                "matcher": { "id": "byName", "options": "duration" },
                "properties": [{ "id": "unit", "value": "ms" }, { "id": "decimals", "value": 2 }]
              }
            ]
          },
          "gridPos": { "h": 12, "w": 24, "x": 0, "y": 43 },
          "id": 60,
          "options": {
            "cellHeight": "sm",
            "showHeader": true,
            "sortBy": [{ "desc": true, "displayName": "startTime" }]
          },
          "title": "Trace Search",
          "type": "table",
          "targets": [
            {
              "datasource": { "type": "jaeger", "uid": "jaeger" },
              "queryType": "search",
              "service": "$application",
              "refId": "A"
            }
          ]
        }
      ]
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["chaekpool", "apm", "spring-boot"],
  "templating": {
    "list": [
      {
        "current": { "selected": false, "text": "chaekpool-api", "value": "chaekpool-api" },
        "datasource": { "type": "prometheus", "uid": "prometheus" },
        "definition": "label_values(application)",
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "application",
        "options": [],
        "query": { "qryType": 1, "query": "label_values(application)", "refId": "PrometheusVariableQueryEditor-VariableQuery" },
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": { "selected": false, "text": "local", "value": "local" },
        "datasource": { "type": "loki", "uid": "loki" },
        "definition": "",
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "environment",
        "options": [],
        "query": { "label": "environment", "stream": "{app=\"chaekpool-api\"}", "type": 1, "refId": "LokiVariableQueryEditor-VariableQuery" },
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": { "selected": true, "text": ["All"], "value": ["$__all"] },
        "datasource": { "type": "prometheus", "uid": "prometheus" },
        "definition": "label_values(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\"}, uri)",
        "hide": 0,
        "includeAll": true,
        "multi": true,
        "name": "uri",
        "options": [],
        "query": { "qryType": 1, "query": "label_values(http_server_requests_seconds_count{application=\"$application\", uri!=\"/actuator/prometheus\"}, uri)", "refId": "PrometheusVariableQueryEditor-VariableQuery" },
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": { "selected": true, "text": ["All"], "value": ["$__all"] },
        "datasource": { "type": "prometheus", "uid": "prometheus" },
        "definition": "label_values(http_server_requests_seconds_count{application=\"$application\"}, method)",
        "hide": 0,
        "includeAll": true,
        "multi": true,
        "name": "method",
        "options": [],
        "query": { "qryType": 1, "query": "label_values(http_server_requests_seconds_count{application=\"$application\"}, method)", "refId": "PrometheusVariableQueryEditor-VariableQuery" },
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "Asia/Seoul",
  "title": "Chaekpool API Overview",
  "uid": "chaekpool-api-overview",
  "version": 1
}
